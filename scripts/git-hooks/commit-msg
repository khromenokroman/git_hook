#!/bin/bash

COMMIT_MSG_FILE=$1
COMMIT_MSG=$(cat "$COMMIT_MSG_FILE")

# Список разрешенных префиксов
ALLOWED_PREFIXES="feat|fix|docs|style|refactor|perf|test|build|ci|chore|revert"

# Проверка, начинается ли сообщение коммита с одного из разрешенных префиксов
if ! echo "$COMMIT_MSG" | grep -qE "^($ALLOWED_PREFIXES)(\([a-z0-9-]+\))?: .+"; then
    echo "ОШИБКА: Неверный формат сообщения коммита."
    echo "Сообщение должно начинаться с одного из следующих префиксов:"
    echo "feat, fix, docs, style, refactor, perf, test, build, ci, chore, revert"
    echo ""
    echo "Примеры:"
    echo "  feat: добавлена новая функция"
    echo "  fix(parser): исправлена ошибка в парсере"
    echo "  docs: обновлена документация"
    exit 1
fi

exit 0